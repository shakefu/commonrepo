#########
# Sources
#
# Source repositories define which of their files should be imported into the
# child repository.
#
# This should be defined in the `.commonrepo.yml` file.
#
# The bare minimum configuration is a single `include: ["**/*"]` entry.

# include opts-in files and folders based on globbing patterns
include:
  # Everything
  - "**/*"
  # Every hidden file
  - .*
  # Every hidden directory
  - .*/**/*
  # Everything in the files/ directory
  - files/**/*
  # Individual file
  - .gitignore

# after the full list of included files is built, the exclusion filters are
# applied to remove any unwanted files from the working list
exclude:
  # Template related workflows
  - .github/workflows/template_*
  # Markdown files
  - "**/*.md"

# after the filtered list is created, destination file names are generated by
# passing the working list through the rename transforms, in order
rename:
  # Rename a path
  - "badname/(.*)": "goodname/%[1]s"
  # Strip one directory from the path
  - "^files/(.*)": "%[1]s"
  # Strip multiple directories from the path
  - "some/parent/dir/(.*)": "%[1]s"
  # Recompose directories
  - "parent/([^/]+)/dir/(.*)": "%[1]s/%[2]s"
  # Add a prefix to the path
  - "(.*\\.md)": "docs/%[1]s"

###########
# Consumers
#
# Consumer repositories can define which sources they want to consume from, as
# well as apply additional filters to the ones defined in the sources.

# define a list of source repositories, which mimic the consumer repos keys
upstream:
  - url: https://github.com/shakefu/commonrepo
    include: [.*]
    exclude: [.gitignore]
    rename: [{".*\\.md": "docs/%[1]s"}]

